worker_processes 1;

events { worker_connections 1024; }

http {

    sendfile on;

    upstream web {
        server 35.157.178.106:81;
        server 35.157.253.101:81;
        server 192.168.99.102:81;
    }

    upstream backofficeweb {
        server 35.157.178.106:84;
        server 35.157.253.101:84;
        server 52.59.153.218:84;
    }

    upstream authenticationservice {
        server 35.157.178.106:8040;
        server 35.157.253.101:8040;
        server 52.59.153.218:8040;
    }

    upstream useraccountandservice {
        server 35.157.178.106:8039;
        server 35.157.253.101:8039;
        server 52.59.153.218:8039;
    }

    upstream socketservice {
        server 35.157.178.106:8038;
        server 35.157.253.101:8038;
        server 52.59.153.218:8038;
    }

    upstream messageservice {
        server 35.157.178.106:8037;
        server 35.157.253.101:8037;
        server 52.59.153.218:8037;
    }

    upstream historyservice {
        server 35.157.178.106:8051;
        server 35.157.253.101:8051;
        server 52.59.153.218:8051;
    }

    upstream transactionservice {
        server 35.157.178.106:8020;
        server 35.157.253.101:8020;
        server 52.59.153.218:8020;
    }
    server {
        listen 81;

        #server_name example1.com;

        location / {
            proxy_pass https://web/;
          }
    }

    server {
        listen 84;
        #server_name example2.com;

        location / {
            proxy_pass https://backofficeweb/;
          }
    }

    server {
        listen 84;
        #server_name example2.com;

        location / {
            proxy_pass https://backofficeweb/;
          }
    }


    server {
        listen 8040;
        #server_name example2.com;

        location / {
        proxy_pass         http://authenticationservice;
         proxy_redirect     off;
         proxy_set_header   Host $host;
         proxy_set_header   X-Real-IP $remote_addr;
         proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header   X-Forwarded-Host $server_name;
         add_header         X-Upstream $upstream_addr;
      }
     }

      server {
          listen 8039;
          #server_name example2.com;

          location / {
          proxy_pass         http://userandaccountservice;
           proxy_redirect     off;
           proxy_set_header   Host $host;
           proxy_set_header   X-Real-IP $remote_addr;
           proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header   X-Forwarded-Host $server_name;
           add_header         X-Upstream $upstream_addr;
        }
     }

     server {
         listen 8039;
         #server_name example2.com;

         location / {
         proxy_pass         http://socketservice;
          proxy_redirect     off;
          proxy_set_header   Host $host;
          proxy_set_header   X-Real-IP $remote_addr;
          proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header   X-Forwarded-Host $server_name;
          add_header         X-Upstream $upstream_addr;
       }
    }


    server {
        listen 8037;
        #server_name example2.com;

        location / {
        proxy_pass         http://messageservice;
         proxy_redirect     off;
         proxy_set_header   Host $host;
         proxy_set_header   X-Real-IP $remote_addr;
         proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header   X-Forwarded-Host $server_name;
         add_header         X-Upstream $upstream_addr;
      }
   }

   server {
       listen 8051;
       #server_name example2.com;

       location / {
       proxy_pass         http://historyservice;
        proxy_redirect     off;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Host $server_name;
        add_header         X-Upstream $upstream_addr;
     }
  }

  server {
      listen 8020;
      #server_name example2.com;

      location / {
      proxy_pass         http://transactionservice;
       proxy_redirect     off;
       proxy_set_header   Host $host;
       proxy_set_header   X-Real-IP $remote_addr;
       proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_set_header   X-Forwarded-Host $server_name;
       add_header         X-Upstream $upstream_addr;
    }
 }


}
